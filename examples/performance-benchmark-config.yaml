# EvalScope æ€§èƒ½åŸºå‡†æµ‹è¯•ä¸“ç”¨é…ç½®
# åŒ…å«å…¨é¢çš„æ€§èƒ½æŒ‡æ ‡ã€å¹¶å‘æµ‹è¯•ã€å‹åŠ›æµ‹è¯•ç­‰åœºæ™¯

evalscope:
  # ======================== æ¨¡å‹é…ç½® ========================
  models:
    # æ¨¡å‹1: OpenAI GPT-3.5 Turbo (é«˜æ€§èƒ½å•†ä¸šæ¨¡å‹)
    gpt-3-5-turbo-performance:
      type: "chat"
      provider: "openai"
      enabled: false  # éœ€è¦é…ç½®APIå¯†é’¥
      parameters:
        model_name: "gpt-3.5-turbo"
        max_tokens: 1000
        temperature: 0.1  # æ€§èƒ½æµ‹è¯•ä¿æŒä½æ¸©åº¦æé«˜å¯é¢„æµ‹æ€§
        top_p: 1.0
        request_timeout_ms: 30000
      credentials:
        api_key: "${OPENAI_API_KEY}"

    # æ¨¡å‹2: GPT-4 (é«˜æ€§èƒ½ä½†æˆæœ¬è¾ƒé«˜)
    gpt-4-performance:
      type: "chat"
      provider: "openai"
      enabled: false  # éœ€è¦é…ç½®APIå¯†é’¥
      parameters:
        model_name: "gpt-4"
        max_tokens: 1000
        temperature: 0.1
        request_timeout_ms: 60000
      credentials:
        api_key: "${OPENAI_API_KEY}"

    # æ¨¡å‹3: é«˜è´¨é‡æœ¬åœ°æ¨¡å‹ (æ¨ç†èƒ½åŠ›å¼±ä½†æˆæœ¬å…è´¹)
    local-llama-13b-performance:
      type: "chat"
      provider: "custom"
      enabled: true
      parameters:
        model_name: "llama-2-13b-chat"
        endpoint: "http://localhost:8080/v1/completions"
        max_tokens: 1000
        temperature: 0.1
        top_k: 40
        top_p: 0.7
        request_timeout_ms: 45000
      credentials:
        api_key: "local-key"

    # æ¨¡å‹4: Mockæ¨¡å‹ (åŸºå‡†æµ‹è¯•å’Œè°ƒè¯•)
    mock-model-standard:
      type: "chat"
      provider: "mock"
      enabled: true
      parameters:
        endpoint: "mock://localhost:8080"
        max_tokens: 500
        temperature: 0.7
        response_delay_ms: 200  # 0.2ç§’æ¨¡æ‹Ÿå“åº”å»¶è¿Ÿ
        response_variation_ms: 50  # Â±50mséšæœºå»¶è¿Ÿ
        success_rate: 0.95  # 95%æˆåŠŸç‡
        availability_rate: 1.0  # å®Œå…¨å¯ç”¨
      credentials:
        mock_auth: "test-mock"

    # æ¨¡å‹5: å“åº”å¯æ§åˆ¶çš„Mockæ¨¡å‹
    mock-model-performance:
      type: "chat"
      provider: "mock"
      enabled: true
      parameters:
        endpoint: "mock://localhost:8081"
        max_tokens: 1000
        temperature: 0.1
        response_delay_ms: 150  # æ¯”æ ‡å‡†æ¨¡å‹æ›´å¿«
        response_variation_ms: 30
        success_rate: 0.98
        simulate_load_delay: true
      credentials:
        mock_auth: "perf-mock"

    # æ¨¡å‹6: æ…¢é€ŸMockæ¨¡å‹ (æ¨¡æ‹Ÿé«˜è´Ÿè½½ç¯å¢ƒ)
    mock-model-stress:
      type: "chat"
      provider: "mock"
      enabled: true
      parameters:
        endpoint: "mock://localhost:8082"
        max_tokens: 2000
        temperature: 0.5
        response_delay_ms: 800  # æ…¢å“åº”æ¨¡æ‹Ÿè´Ÿè½½
        response_variation_ms: 100
        success_rate: 0.85  # è¾ƒä½æˆåŠŸç‡
      credentials:
        mock_auth: "stress-mock"

  # ======================== æ€§èƒ½è¯„ä¼°ç±»å‹ ========================
  evaluations:
    # åŸºå‡†æµ‹è¯•ï¼šæ ‡å‡†æ€§èƒ½å¯¹æ¯”
    benchmark_standard:
      models: ["mock-model-standard", "mock-model-performance"]
      evaluators: ["chat"]
      maxConcurrency: 1
      saveResults: true
      outputPath: "results/benchmark-standard"
      parameters:
        max_examples: 50
        timeout_seconds: 10
        warmup_iterations: 5
        test_iterations: 100
        concurrent_levels: [1, 5, 10, 20]
        benchmark_focus: "response_time"  # ä¸“æ³¨å“åº”æ—¶é—´

    # å‹åŠ›æµ‹è¯•ï¼šé«˜å¹¶å‘æé™æµ‹è¯•
    stress_test:
      models: ["mock-model-performance", "mock-model-stress"]
      evaluators: ["chat"]
      maxConcurrency: 20
      saveResults: true
      outputPath: "results/stress-test"
      parameters:
        max_examples: 200
        timeout_seconds: 30
        warmup_iterations: 10
        test_iterations: 500
        concurrent_levels: [10, 20, 50, 100]
        load_pattern: "ramp_up"  # é€æ­¥å¢åŠ è´Ÿè½½
        duration_minutes: 60

    # é•¿æœŸç¨³å®šæ€§æµ‹è¯• (Longevity Test)
    longevity_test:
      models: ["mock-model-performance"]
      evaluators: ["chat"]
      maxConcurrency: 5
      saveResults: true
      outputPath: "results/longevity"
      parameters:
        max_examples: 1000
        timeout_seconds: 15
        warmup_iterations: 20
        test_iterations: 5000
        concurrent_levels_per_minute: [5, 10, 15, 5]
        test_duration_hours: 6
        memory_tracking: true
        error_recovery_tracking: true

    # æ··åˆæ€§èƒ½æµ‹è¯•ï¼šå¯¹æ¯”ä¸åŒè§„æ¨¡æ¨¡å‹
    comparative_stress:
      models: ["mock-model-standard", "mock-model-performance", "mock-model-stress"]
      evaluators: ["chat"]
      maxConcurrency: 10
      saveResults: true
      outputPath: "results/comparative"
      parameters:
        max_examples: 300
        timeout_seconds: 25
        warmup_iterations: 15
        test_iterations: 800
        concurrent_levels: [5, 10, 15]
        comparison_metrics: ["throughput", "latency", "reliability"]
        statistical_significance_test: true

    # å¼¹æ€§åŸºå‡†æµ‹è¯•ï¼šæ•…éšœæ¢å¤èƒ½åŠ›
    resiliency_test:
      models: ["mock-model-standard"]
      evaluators: ["chat"]
      maxConcurrency: 15
      saveResults: true
      outputPath: "results/resiliency"
      parameters:
        max_examples: 250
        timeout_seconds: 20
        warmup_iterations: 5
        test_iterations: 150
        post_error_recovery_tests: true
        circuit_breaker_simulation: true
        availability_tracking: true

  # ======================== æ€§èƒ½ç›‘æ§è®¾ç½® ========================
  settings:
    # æ€§èƒ½ç›¸å…³ç³»ç»Ÿçº§é…ç½®
    max_job_concurrency: 10
    response_timeout_seconds: 60
    result_format: "json"
    log_level: "INFO"

    # æ€§èƒ½ç›‘æ§ä¸“ç”¨è®¾ç½®
    performance_monitoring:
      enable_metrics_collection: true
      metrics_database_path: "metrics/performance.db"

      # JVMæ€§èƒ½ç›‘æ§
      jvm_metrics:
        heap_memory: true
        gc_activity: true
        thread_count: true

      # ç½‘ç»œæ€§èƒ½æŒ‡æ ‡
      network_metrics:
        connection_pool_stats: true
        response_time_histogram: true
        error_rate_tracking: true

      # æˆæœ¬æ•ˆç›Šåˆ†æ
      cost_tracking:
        enable_terser_cost_calculation: true
        pricing_model: "token_based"
        currency: "USD"
        cost_per_1k_tokens: 0.002

    # ä¼ä¸šé›†æˆ
    enterprise:
      prometheus_metrics_enabled: true
      grafana_dashboards: true
      alerting:
        slack_webhook: "${SLACK_WEBHOOK_URL}"
        thresholds:
          response_time_ms: 5000
          error_rate_percent: 2.0
          availability_percent: 99.5

      # APMé›†æˆ
      apm_integration:
        enabled: false
        service_name: "evalscope-performance"
        jaeger_enabled: false

## ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

### æ ‡å‡†æ€§èƒ½åŸºå‡†æµ‹è¯•
```bash
mvn exec:java -Dexec.mainClass="com.evalscope.EvalScopeRunner" \
  -Dexec.args="benchmark_standard"
```

### å‹åŠ›æµ‹è¯• (å¹¶å‘50)
```bash
mvn exec:java -Dexec.mainClass="com.evalscope.EvalScopeRunner" \
  -Dexec.args="stress_test" \
  -Dexec.vmArguments="-Xms1g -Xmx2g"  # å†…å­˜è°ƒä¼˜
```

### é•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•
```bash
# ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š
mvn exec:java -Dexec.mainClass="com.evalscope.EvalScopeRunner" \
  -Dexec.args="longevity_test"

# åœ¨åå°è¿è¡ŒæŒç»­é•¿æ—¶é—´çš„æµ‹è¯•
nohup mvn exec:java -Dexec.mainClass="com.evalscope.EvalScopeRunner" \
  -Dexec.args="longevity_test" > benchmark.log 2>&1 &
```

### ä½¿ç”¨Dockerå®¹å™¨åŒ–æµ‹è¯•
```dockerfile
FROM openjdk:11-jre-slim

WORKDIR /app/evalscope

COPY target/evalscope-java-1.0.0.jar app.jar
COPY examples/performance-benchmark-config.yaml src/main/resources/application.yaml

# JVMæ€§èƒ½é…ç½® for benchmarks
ENV JAVA_OPTS="-Xmx2g -XX:+UseG1GC -XX:+PrintGCDetails"

# å¯åŠ¨æ€§èƒ½æµ‹è¯•
CMD ["java", "-jar", "app.jar", "stress_test"]
```

## ğŸ”§ è¿è¡Œä¸­çš„å‚æ•°è°ƒä¼˜

```bash
# å»ºè®®çš„JVMè°ƒä¼˜ (å†…å­˜/åƒåœ¾æ”¶é›†)
export MAVEN_OPTS="-Xms1g -Xmx4g -XX:+UnlockExperimentalVMOptions -XX:+UseG1GC"

# Dockerfile JVMé…ç½®
ENV JAVA_OPTS="-Xmx2g -XX:+UseZGC -XX:+PrintGCDetails -XX:+UseCompressedOops"
```

## ğŸ“Š ç»“æœåˆ†æè¦ç‚¹

### æ ¸å¿ƒæŒ‡æ ‡è§‚å¯Ÿ
1. **å“åº”æ—¶é—´åˆ†å¸ƒ**: min/max/avg/p95/p99
2. **ååé‡è¶‹åŠ¿**: ä¸åŒå¹¶å‘çº§åˆ«çš„æ€§èƒ½å˜åŒ–
3. **é”™è¯¯ç‡å˜åŒ–**: è´Ÿè½½å¢åŠ æ—¶å¯é æ€§åˆ†æ
4. **èµ„æºåˆ©ç”¨ç‡**: å†…å­˜ã€CPUéšè´Ÿè½½å˜åŒ–

### æ‰©å±•æµ‹è¯•
å¯åŸºäºæ­¤é…ç½®æ·»åŠ ï¼š
- æ›´ç²¾ç»†çš„æˆæœ¬åˆ†æ
- è¯¦ç»†çš„æ•…éšœæ³¨å…¥æµ‹è¯•
- å¤šåœ°åŸŸéƒ¨ç½²æ€§èƒ½è¯„ä¼°
- åŠ¨æ€æ‰©ç¼©å®¹æ•ˆæœéªŒè¯

è¿™å¥—é…ç½®ä¸ºç”Ÿäº§ç¯å¢ƒçš„AIæœåŠ¡æä¾›äº†å…¨é¢çš„æ€§èƒ½åŸºå‡†æµ‹è¯•æ¡†æ¶ï¼ğŸ”¥